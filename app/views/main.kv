BoxLayout:
    orientation: 'vertical'
    spacing: 15
    padding: [30, 30, 30, 30]
    canvas.before:
        Color:
            rgba: 0.1, 0.1, 0.1, 1
        Rectangle:
            pos: self.pos
            size: self.size

    Label:
        text: "DISPARADOR OUTLOOK"
        font_size: '24sp'
        bold: True
        size_hint_y: None
        height: 50
        color: 1, 1, 1, 1

    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: 50
        spacing: 10

        Button:
            text: "SELECIONAR PLANILHA"
            size_hint_x: 0.7
            on_press: root.open_file_dialog(self)
            background_color: 0.2, 0.6, 1, 1
            color: 1, 1, 1, 1

        Label:
            id: file_label
            text: "No file selected"
            size_hint_x: 1.3
            color: 0.5, 0.5, 0.5, 1

    TextInput:
        id: sender_input
        hint_text: "Remetente"
        size_hint_y: None
        height: 50
        multiline: False
        padding: [10, 10]
        font_size: '16sp'
        background_color: 0.2, 0.2, 0.2, 1
        foreground_color: 1, 1, 1, 1

    Spinner:
        id: body_spinner
        text: "Selecione"
        values: []
        size_hint_y: None
        height: 50
        background_color: 0.2, 0.2, 0.2, 1
        color: 1, 1, 1, 1
        on_text: root.on_body_spinner_select(self, self.text)

    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: 50
        spacing: 10

        Button:
            text: "B"
            font_size: '20sp'
            bold: True
            on_press: root.apply_format("Negrito")
            background_color: 0.2, 0.6, 1, 1
            color: 1, 1, 1, 1

        Button:
            text: "I"
            font_size: '20sp'
            italic: True
            on_press: root.apply_format("Itálico")
            background_color: 0.2, 0.6, 1, 1
            color: 1, 1, 1, 1

        Button:
            text: "U"
            font_size: '20sp'
            underline: True
            on_press: root.apply_format("Sublinhado")
            background_color: 0.2, 0.6, 1, 1
            color: 1, 1, 1, 1

        Button:
            text: "A+"
            font_size: '20sp'
            on_press: root.apply_format("Aumentar Fonte")
            background_color: 0.2, 0.6, 1, 1
            color: 1, 1, 1, 1

    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: 50
        spacing: 10

        BoxLayout:
            orientation: 'horizontal'
            size_hint_x: 0.5
            spacing: 5

            Label:
                text: "Hiperlink"
                color: 1, 1, 1, 1

            CheckBox:
                on_active: root.toggle_hyperlink(self, self.active)

        BoxLayout:
            orientation: 'horizontal'
            size_hint_x: 0.5
            spacing: 5

            Label:
                text: "Quebras de Linha:"
                color: 1, 1, 1, 1

            Spinner:
                text: "0"
                values: ["0", "1", "2", "3", "4", "5"]
                size_hint_y: None
                height: 50
                background_color: 0.2, 0.2, 0.2, 1
                color: 1, 1, 1, 1
                on_text: root.update_line_breaks(self, self.text)

    Label:
        id: preview_label
        text: "Pré-visualização"
        size_hint_y: None
        height: 50
        font_size: '16sp'
        color: 1, 1, 1, 1

    Button:
        text: "Enviar"
        size_hint_y: None
        height: 50
        bold: True
        background_color: 0.2, 0.6, 1, 1
        color: 1, 1, 1, 1
        on_press: root.schedule_send_emails(self)

    Label:
        id: status_label
        text: ""
        size_hint_y: None
        height: 50
        color: 1, 1, 1, 1
